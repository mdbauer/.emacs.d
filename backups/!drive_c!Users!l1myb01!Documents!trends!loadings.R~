## our general model with inflation cycle and real-rate gap
rho.c <- 0.95
rho.g <- 0.95
rho.x <- 0.99
lam.pistar <- -0.01
lam.rstar <- -.02
lam.c <- 0.01
lam.g <- 0.01

N <- 600
B.pistar <- numeric(N)
B.c <- numeric(N) #
B.rstar <- numeric(N)
B.g <- numeric(N) #
B.x <- numeric(N)
B.pistar[1] <- -1
B.c[1] <- -1
B.rstar[1] <- -1
B.g[1] <- 0
B.x[1] <- 0

for (n in 2:N) {
    B.pistar[n] <- -1 + B.pistar[n-1]
    B.c[n] <- -1 + rho.c*B.c[n-1]
    B.rstar[n] <- -1 + B.rstar[n-1]
    B.g[n] <- -1 + rho.g*B.c[n-1]
    B.x[n] <- B.x[n-1]*rho.x - B.pistar[n-1]*lam.pistar - B.c[n-1]*lam.c - B.rstar[n-1]*lam.rstar - B.g[n-1]*lam.g
}

cols <- c("black", "green", "blue", "yellow", "red")
plot(-B.pistar/(1:N), ylab="Loadings", xlab="Maturity", col=cols[1], ylim=range(-B.x/(1:N)), type="l", lwd=2, lty=1)
lines(-B.c/(1:N), col=cols[2], lwd=2, lty=2)
lines(-B.rstar/(1:N), col=cols[3], lwd=2, lty=3)
lines(-B.g/(1:N), col=cols[4], lwd=2, lty=3)
lines(-B.x/(1:N), col=cols[5], lwd=2, lty=1)
## abline(h=0, lty=2)
legend("bottomright", c("pi*", "c", "r*", "g", "x=RP"), col=cols, bg="white", lwd=c(2,2,2,2,2), lty=c(1,2,3,3,1), cex=0.8)

