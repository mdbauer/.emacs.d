## Author: David Zarruk Valencia  #
## Date:   June, 2017             #
## edited by Michael Bauer

library("Rcpp")

sourceCpp("value_fn.cpp")

# Grid for x
nx            = 300;
xmin          = 0.1;
xmax          = 4.0;

# Grid for e: parameters for Tauchen
ne            = 15;
ssigma_eps    = 0.02058;
llambda_eps   = 0.99;
m             = 1.5;

# Utility function
ssigma        = 2;
eeta          = 0.36;
ppsi          = 0.89;
rrho          = 0.5;
llambda       = 1;
bbeta         = 0.97;
T             = 10;

# Prices
r             = 0.07;
w             = 5;

print("Life cycle computation: ")

## value function iteration in C++
V = value(nx, xmin, xmax,
      ne, ssigma_eps, llambda_eps, m,
      ssigma, eeta, ppsi, rrho, llambda, bbeta, T, r, w);

# reshape to array
Value <- array(V, c(ne, nx, T))
Value <- aperm(Value, c(3,2,1))

print("Check: the first three entries of the value function: ")
print(Value[1, 1, 1:3])

